import{b as ft,e as jt,c as Je,a as F,f as X,t as vt,d as ct}from"../chunks/C5oqtnP4.js";import"../chunks/lwF60enh.js";import{c as Ue,o as yt}from"../chunks/BBC6GmHx.js";import{t as ce,y as pt,I as _t,aa as ut,aK as zt,z as gt,ai as Lt,al as qt,aj as Ft,N as At,a8 as at,E as Vt,aL as Nt,aM as Ut,e as ht,u as xt,aN as Ht,a5 as Bt,q as Wt,w as Fe,ae as mt,af as kt,ag as Kt,G as St,aO as Gt,aP as Jt,p as Te,f as We,a as Re,R as we,c as n,s as c,r as i,m as e,D as j,aQ as Pe,Y as ze,aR as it,d as Qt,aS as Ct,aT as Zt,F as Yt}from"../chunks/CjiiXA-r.js";import{k as Xt,w as er,l as tr,d as Dt,s as ae,r as Ve,e as oe}from"../chunks/jG0SD3Bx.js";import{s as Qe,r as Ze,p as he,i as le,a as rr,b as ar}from"../chunks/Xd8GBmdn.js";import{i as Ne}from"../chunks/BuxUKSqB.js";import{s as sr}from"../chunks/fJtxBR6D.js";import{c as ir,I as Ye,r as He,b as Oe,e as Ge,i as tt,a as Ie,s as qe}from"../chunks/BEv6A3bc.js";import{b as nr}from"../chunks/COy7b4fU.js";import{s as Xe}from"../chunks/oG3m_XG8.js";function or(o,r,s=!1,l=!1,u=!1){var _=o,f="";ce(()=>{var y=ut;if(f===(f=r()??"")){pt&&_t();return}if(y.nodes_start!==null&&(zt(y.nodes_start,y.nodes_end),y.nodes_start=y.nodes_end=null),f!==""){if(pt){gt.data;for(var A=_t(),m=A;A!==null&&(A.nodeType!==8||A.data!=="");)m=A,A=Lt(A);if(A===null)throw qt(),Ft;ft(gt,m),_=At(A);return}var T=f+"";s?T=`<svg>${T}</svg>`:l&&(T=`<math>${T}</math>`);var k=jt(T);if((s||l)&&(k=at(k)),ft(at(k),k.lastChild),s||l)for(;at(k);)_.before(at(k));else _.before(k)}})}const lr=()=>performance.now(),Be={tick:o=>requestAnimationFrame(o),now:()=>lr(),tasks:new Set};function Et(){const o=Be.now();Be.tasks.forEach(r=>{r.c(o)||(Be.tasks.delete(r),r.f())}),Be.tasks.size!==0&&Be.tick(Et)}function cr(o){let r;return Be.tasks.size===0&&Be.tick(Et),{promise:new Promise(s=>{Be.tasks.add(r={c:o,f:s})}),abort(){Be.tasks.delete(r)}}}function st(o,r){er(()=>{o.dispatchEvent(new CustomEvent(r))})}function dr(o){if(o==="float")return"cssFloat";if(o==="offset")return"cssOffset";if(o.startsWith("--"))return o;const r=o.split("-");return r.length===1?r[0]:r[0]+r.slice(1).map(s=>s[0].toUpperCase()+s.slice(1)).join("")}function bt(o){const r={},s=o.split(";");for(const l of s){const[u,_]=l.split(":");if(!u||_===void 0)break;const f=dr(u.trim());r[f]=_.trim()}return r}const vr=o=>o;function $t(o,r,s){var l=ir,u,_,f,y=null;l.a??={element:o,measure(){u=this.element.getBoundingClientRect()},apply(){if(f?.abort(),_=this.element.getBoundingClientRect(),u.left!==_.left||u.right!==_.right||u.top!==_.top||u.bottom!==_.bottom){const A=r()(this.element,{from:u,to:_},s?.());f=ot(this.element,A,void 0,1,()=>{f?.abort(),f=void 0})}},fix(){if(!o.getAnimations().length){var{position:A,width:m,height:T}=getComputedStyle(o);if(A!=="absolute"&&A!=="fixed"){var k=o.style;y={position:k.position,width:k.width,height:k.height,transform:k.transform},k.position="absolute",k.width=m,k.height=T;var p=o.getBoundingClientRect();if(u.left!==p.left||u.top!==p.top){var V=`translate(${u.left-p.left}px, ${u.top-p.top}px)`;k.transform=k.transform?`${k.transform} ${V}`:V}}}},unfix(){if(y){var A=o.style;A.position=y.position,A.width=y.width,A.height=y.height,A.transform=y.transform}}},l.a.element=o}function Ot(o,r,s,l){var u=(o&Ht)!==0,_="both",f,y=r.inert,A=r.style.overflow,m,T;function k(){var J=Kt,C=ut;mt(null),kt(null);try{return f??=s()(r,l?.()??{},{direction:_})}finally{mt(J),kt(C)}}var p={is_global:u,in(){r.inert=y,st(r,"introstart"),m=ot(r,k(),T,1,()=>{st(r,"introend"),m?.abort(),m=f=void 0,r.style.overflow=A})},out(J){r.inert=!0,st(r,"outrostart"),T=ot(r,k(),m,0,()=>{st(r,"outroend"),J?.()})},stop:()=>{m?.abort(),T?.abort()}},V=ut;if((V.transitions??=[]).push(p),Xt){var Q=u;if(!Q){for(var K=V.parent;K&&(K.f&Vt)!==0;)for(;(K=K.parent)&&(K.f&Nt)===0;);Q=!K||(K.f&Ut)!==0}Q&&ht(()=>{xt(()=>p.in())})}}function ot(o,r,s,l,u){var _=l===1;if(Bt(r)){var f,y=!1;return Wt(()=>{if(!y){var J=r({direction:_?"in":"out"});f=ot(o,J,s,l,u)}}),{abort:()=>{y=!0,f?.abort()},deactivate:()=>f.deactivate(),reset:()=>f.reset(),t:()=>f.t()}}if(s?.deactivate(),!r?.duration)return u(),{abort:Fe,deactivate:Fe,reset:Fe,t:()=>l};const{delay:A=0,css:m,tick:T,easing:k=vr}=r;var p=[];if(_&&s===void 0&&(T&&T(0,1),m)){var V=bt(m(0,1));p.push(V,V)}var Q=()=>1-l,K=o.animate(p,{duration:A});return K.onfinish=()=>{var J=s?.t()??1-l;s?.abort();var C=l-J,P=r.duration*Math.abs(C),x=[];if(P>0){var w=!1;if(m)for(var H=Math.ceil(P/16.666666666666668),L=0;L<=H;L+=1){var M=J+C*k(L/H),t=bt(m(M,1-M));x.push(t),w||=t.overflow==="hidden"}w&&(o.style.overflow="hidden"),Q=()=>{var a=K.currentTime;return J+C*k(a/P)},T&&cr(()=>{if(K.playState!=="running")return!1;var a=Q();return T(a,1-a),!0})}K=o.animate(x,{duration:P,fill:"forwards"}),K.onfinish=()=>{Q=()=>l,T?.(l,1-l),u()}},{abort:()=>{K&&(K.cancel(),K.effect=null,K.onfinish=Fe)},deactivate:()=>{u=Fe},reset:()=>{l===0&&T?.(1,0)},t:()=>Q()}}function lt(o,r,s){if(o.multiple)return r==null?void 0:St(r)?hr(o,r):Gt();for(var l of o.options){var u=et(l);if(Jt(u,r)){l.selected=!0;return}}(!s||r!==void 0)&&(o.selectedIndex=-1)}function Pt(o,r){let s=!0;ht(()=>{r&&lt(o,xt(r),s),s=!1;var l=new MutationObserver(()=>{var u=o.__value;lt(o,u)});return l.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{l.disconnect()}})}function ur(o,r,s=r){var l=!0;tr(o,"change",u=>{var _=u?"[selected]":":checked",f;if(o.multiple)f=[].map.call(o.querySelectorAll(_),et);else{var y=o.querySelector(_)??o.querySelector("option:not([disabled])");f=y&&et(y)}s(f)}),ht(()=>{var u=r();if(lt(o,u,l),l&&u===void 0){var _=o.querySelector(":checked");_!==null&&(u=et(_),s(u))}o.__value=u,l=!1}),Pt(o)}function hr(o,r){for(var s of o.options)s.selected=r.includes(et(s))}function et(o){return"__value"in o?o.__value:o.value}function rt(o){return function(...r){var s=r[0];return s.stopPropagation(),o?.apply(this,r)}}function fr(o,r){var s=o.$$events?.[r.type],l=St(s)?s.slice():s==null?[]:[s];for(var u of l)u.call(this,r)}function pr(o,r){Te(r,!0);let s=Ze(r,["$$slots","$$events","$$legacy"]);Ye(o,Qe({name:"funnel"},()=>s,{iconNode:[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z"}]],children:(u,_)=>{var f=Je(),y=We(f);Xe(y,()=>r.children??Fe),F(u,f)},$$slots:{default:!0}})),Re()}function _r(o,r){Te(r,!0);let s=Ze(r,["$$slots","$$events","$$legacy"]);Ye(o,Qe({name:"layout-grid"},()=>s,{iconNode:[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1"}]],children:(u,_)=>{var f=Je(),y=We(f);Xe(y,()=>r.children??Fe),F(u,f)},$$slots:{default:!0}})),Re()}function gr(o,r){Te(r,!0);let s=Ze(r,["$$slots","$$events","$$legacy"]);Ye(o,Qe({name:"list"},()=>s,{iconNode:[["path",{d:"M3 12h.01"}],["path",{d:"M3 18h.01"}],["path",{d:"M3 6h.01"}],["path",{d:"M8 12h13"}],["path",{d:"M8 18h13"}],["path",{d:"M8 6h13"}]],children:(u,_)=>{var f=Je(),y=We(f);Xe(y,()=>r.children??Fe),F(u,f)},$$slots:{default:!0}})),Re()}function It(o,r){Te(r,!0);let s=Ze(r,["$$slots","$$events","$$legacy"]);Ye(o,Qe({name:"printer"},()=>s,{iconNode:[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1"}]],children:(u,_)=>{var f=Je(),y=We(f);Xe(y,()=>r.children??Fe),F(u,f)},$$slots:{default:!0}})),Re()}function Tt(o,r){Te(r,!0);let s=Ze(r,["$$slots","$$events","$$legacy"]);Ye(o,Qe({name:"triangle-alert"},()=>s,{iconNode:[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["path",{d:"M12 9v4"}],["path",{d:"M12 17h.01"}]],children:(u,_)=>{var f=Je(),y=We(f);Xe(y,()=>r.children??Fe),F(u,f)},$$slots:{default:!0}})),Re()}function mr(o,r){Te(r,!0);let s=Ze(r,["$$slots","$$events","$$legacy"]);Ye(o,Qe({name:"upload"},()=>s,{iconNode:[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["polyline",{points:"17 8 12 3 7 8"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15"}]],children:(u,_)=>{var f=Je(),y=We(f);Xe(y,()=>r.children??Fe),F(u,f)},$$slots:{default:!0}})),Re()}function kr(o,r){Te(r,!0);let s=Ze(r,["$$slots","$$events","$$legacy"]);Ye(o,Qe({name:"wand-sparkles"},()=>s,{iconNode:[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72"}],["path",{d:"m14 7 3 3"}],["path",{d:"M5 6v4"}],["path",{d:"M19 14v4"}],["path",{d:"M10 2v2"}],["path",{d:"M7 8H3"}],["path",{d:"M21 16h-4"}],["path",{d:"M11 3H9"}]],children:(u,_)=>{var f=Je(),y=We(f);Xe(y,()=>r.children??Fe),F(u,f)},$$slots:{default:!0}})),Re()}const br=()=>{const o=sr;return{page:{subscribe:o.page.subscribe},navigating:{subscribe:o.navigating.subscribe},updated:o.updated}},wr={subscribe(o){return br().page.subscribe(o)}};function yr(o,r){j(r,!0)}function xr(o,r,s,l,u,_,f,y,A){j(r,!1),j(s,l().title),j(u,l().description),j(_,l().duration),j(f,l().chars),j(y,[...l().character_performers||[]]),j(A,{cues:l().techDetails?.cues||"",props:l().techDetails?.props||"",costume:l().techDetails?.costume||"",stage_dressing:l().techDetails?.stage_dressing||"",chairs:l().techDetails?.chairs||0,stools:l().techDetails?.stools||0,other_props:l().techDetails?.other_props||""})}function Sr(o,r,s,l,u,_,f,y,A,m){const T={...r(),title:e(s),description:e(l),duration:e(u),chars:e(_),casted:e(f).length,character_performers:e(f),techDetails:{id:r().techDetails?.id||crypto.randomUUID(),sketch_id:r().id,...e(y),created_at:r().techDetails?.created_at||new Date().toISOString(),updated_at:new Date().toISOString()}};A("update",{sketch:T}),j(m,!1)}var Cr=o=>o.stopPropagation(),Dr=(o,r)=>o.key==="Enter"&&r(),Er=(o,r,s)=>r(e(s).id),$r=X('<li class="svelte-kenoik"><span class="character svelte-kenoik"> </span> <span class="performer svelte-kenoik"> </span> <button type="button" class="remove-button svelte-kenoik">×</button></li>'),Or=X('<div class="character-list svelte-kenoik"><h4>Current Assignments</h4> <ul class="svelte-kenoik"></ul></div>'),Pr=X('<div class="edit-form svelte-kenoik"><div class="form-group svelte-kenoik"><label for="title" class="svelte-kenoik">Title</label> <input type="text" id="title" required class="svelte-kenoik"/></div> <div class="form-group svelte-kenoik"><label for="description" class="svelte-kenoik">Description</label> <textarea id="description" class="svelte-kenoik"></textarea></div> <div class="form-group svelte-kenoik"><label for="duration" class="svelte-kenoik">Duration (minutes)</label> <input type="number" id="duration" min="1" required class="svelte-kenoik"/></div> <div class="form-group svelte-kenoik"><label for="chars" class="svelte-kenoik">Number of Characters</label> <input type="number" id="chars" min="1" required class="svelte-kenoik"/></div> <div class="form-group svelte-kenoik"><label class="svelte-kenoik">Character Assignments</label> <div class="character-inputs svelte-kenoik"><input type="text" placeholder="Character name" class="svelte-kenoik"/> <input type="text" placeholder="Performer name" class="svelte-kenoik"/> <button type="button" class="svelte-kenoik">Add</button></div></div> <!> <div class="form-group svelte-kenoik"><label class="svelte-kenoik">Tech Details</label> <div class="tech-grid svelte-kenoik"><div class="tech-item svelte-kenoik"><label for="cues" class="svelte-kenoik">Cues</label> <textarea id="cues" class="svelte-kenoik"></textarea></div> <div class="tech-item svelte-kenoik"><label for="props" class="svelte-kenoik">Props</label> <textarea id="props" class="svelte-kenoik"></textarea></div> <div class="tech-item svelte-kenoik"><label for="costume" class="svelte-kenoik">Costume</label> <textarea id="costume" class="svelte-kenoik"></textarea></div> <div class="tech-item svelte-kenoik"><label for="stage_dressing" class="svelte-kenoik">Stage Dressing</label> <textarea id="stage_dressing" class="svelte-kenoik"></textarea></div> <div class="tech-item svelte-kenoik"><label for="chairs" class="svelte-kenoik">Chairs</label> <input type="number" id="chairs" min="0" class="svelte-kenoik"/></div> <div class="tech-item svelte-kenoik"><label for="stools" class="svelte-kenoik">Stools</label> <input type="number" id="stools" min="0" class="svelte-kenoik"/></div> <div class="tech-item svelte-kenoik"><label for="other_props" class="svelte-kenoik">Other Props</label> <textarea id="other_props" class="svelte-kenoik"></textarea></div></div></div> <div class="form-actions svelte-kenoik"><button type="button" class="svelte-kenoik">Cancel</button> <button type="button" class="svelte-kenoik">Save</button></div></div>'),Ir=X('<p class="description svelte-kenoik"> </p>'),Tr=X('<div class="cast-item svelte-kenoik"><span class="character-name svelte-kenoik"> </span> <span class="performer-name svelte-kenoik"> </span></div>'),Rr=X('<div class="cast-section svelte-kenoik"><h4 class="section-title svelte-kenoik">Cast</h4> <div class="cast-grid svelte-kenoik"></div></div>'),Mr=X('<div class="tech-grid svelte-kenoik"><div class="tech-item svelte-kenoik"><label for="cues">Cues</label> <textarea id="cues"></textarea></div> <div class="tech-item svelte-kenoik"><label for="props">Props</label> <textarea id="props"></textarea></div> <div class="tech-item svelte-kenoik"><label for="costume">Costume</label> <textarea id="costume"></textarea></div> <div class="tech-item svelte-kenoik"><label for="stage_dressing">Stage Dressing</label> <textarea id="stage_dressing"></textarea></div> <div class="tech-item svelte-kenoik"><label for="chairs">Chairs</label> <input type="number" id="chairs" min="0"/></div> <div class="tech-item svelte-kenoik"><label for="stools">Stools</label> <input type="number" id="stools" min="0"/></div> <div class="tech-item svelte-kenoik"><label for="other_props">Other Props</label> <textarea id="other_props"></textarea></div></div>'),jr=X('<div class="tech-item svelte-kenoik"><span class="tech-label svelte-kenoik">Cues</span> <span class="tech-value svelte-kenoik"> </span></div>'),zr=X('<div class="tech-item svelte-kenoik"><span class="tech-label svelte-kenoik">Props</span> <span class="tech-value svelte-kenoik"> </span></div>'),Lr=X('<div class="tech-item svelte-kenoik"><span class="tech-label svelte-kenoik">Costume</span> <span class="tech-value svelte-kenoik"> </span></div>'),qr=X('<div class="tech-item svelte-kenoik"><span class="tech-label svelte-kenoik">Stage Dressing</span> <span class="tech-value svelte-kenoik"> </span></div>'),Fr=X('<div class="tech-item svelte-kenoik"><span class="tech-label svelte-kenoik">Furniture</span> <span class="tech-value svelte-kenoik"> </span></div>'),Ar=X('<div class="tech-item svelte-kenoik"><span class="tech-label svelte-kenoik">Other Props</span> <span class="tech-value svelte-kenoik"> </span></div>'),Vr=X('<div class="tech-grid svelte-kenoik"><!> <!> <!> <!> <!> <!></div>'),Nr=X('<p class="no-tech-details svelte-kenoik">No tech details available for this sketch.</p>'),Ur=X('<div class="view-mode svelte-kenoik"><div class="header svelte-kenoik"><h2 class="svelte-kenoik"> </h2> <button type="button" class="edit-button svelte-kenoik">Edit</button></div> <!> <div class="stats-container svelte-kenoik"><div class="stat-item svelte-kenoik"><span class="stat-label svelte-kenoik">Duration</span> <span class="stat-value svelte-kenoik"> </span></div> <div class="stat-item svelte-kenoik"><span class="stat-label svelte-kenoik">Characters</span> <span class="stat-value svelte-kenoik"> </span></div> <div class="stat-item svelte-kenoik"><span class="stat-label svelte-kenoik">Casted</span> <span class="stat-value svelte-kenoik"> </span></div></div> <!> <div class="tech-section svelte-kenoik"><h4 class="section-title svelte-kenoik">Tech Details</h4> <!></div></div>'),Hr=X('<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"><div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"><div class="p-6"><div class="flex justify-between items-start mb-4"><div class="flex items-center gap-4"><button type="button" class="text-gray-500 hover:text-gray-700 focus:outline-none" aria-label="Back to show"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg></button> <h2 class="text-2xl font-bold text-gray-900"> </h2></div> <button type="button" class="text-gray-500 hover:text-gray-700 focus:outline-none" aria-label="Close details"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <!></div></div></div>');function Br(o,r){Te(r,!1);let s=he(r,"sketch",8);const l=Ue();let u=we(!1),_=we(s().title),f=we(s().description),y=we(s().duration),A=we(s().chars),m=we(""),T=we(""),k=we([...s().character_performers||[]]),p=we({cues:s().techDetails?.cues||"",props:s().techDetails?.props||"",costume:s().techDetails?.costume||"",stage_dressing:s().techDetails?.stage_dressing||"",chairs:s().techDetails?.chairs||0,stools:s().techDetails?.stools||0,other_props:s().techDetails?.other_props||""});function V(){!e(m)||!e(T)||(j(k,[...e(k),{id:crypto.randomUUID(),sketch_id:s().id,character_name:e(m),performer_name:e(T),created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]),j(m,""),j(T,""))}function Q(N){j(k,e(k).filter(ie=>ie.id!==N))}function K(N){N.stopPropagation(),l("close")}function J(N){N.key==="Escape"&&K(N)}yt(()=>(document.addEventListener("keydown",J),()=>document.removeEventListener("keydown",J))),Ne();var C=Hr();C.__click=K;var P=n(C);P.__click=[Cr];var x=n(P),w=n(x),H=n(w),L=n(H);L.__click=K;var M=c(L,2),t=n(M,!0);i(M),i(H);var a=c(H,2);a.__click=K,i(w);var d=c(w,2);{var D=N=>{var ie=Pr(),fe=n(ie),pe=c(n(fe),2);He(pe),i(fe);var te=c(fe,2),re=c(n(te),2);Ve(re),i(te);var z=c(te,2),ve=c(n(z),2);He(ve),i(z);var G=c(z,2),Y=c(n(G),2);He(Y),i(G);var E=c(G,2),O=c(n(E),2),Z=n(O);He(Z);var ne=c(Z,2);He(ne),ne.__keydown=[Dr,V];var ue=c(ne,2);ue.__click=V,i(O),i(E);var h=c(E,2);{var g=se=>{var Ae=Or(),je=c(n(Ae),2);Ge(je,5,()=>e(k),tt,(Me,Ce)=>{var Ke=$r(),xe=n(Ke),De=n(xe,!0);i(xe);var $e=c(xe,2),Le=n($e,!0);i($e);var dt=c($e,2);dt.__click=[Er,Q,Ce],i(Ke),ce(()=>{ae(De,e(Ce).character_name),ae(Le,e(Ce).performer_name)}),F(Me,Ke)}),i(je),i(Ae),F(se,Ae)};le(h,se=>{e(k).length>0&&se(g)})}var $=c(h,2),v=c(n($),2),q=n(v),B=c(n(q),2);Ve(B),i(q);var U=c(q,2),W=c(n(U),2);Ve(W),i(U);var R=c(U,2),ee=c(n(R),2);Ve(ee),i(R);var b=c(R,2),S=c(n(b),2);Ve(S),i(b);var ye=c(b,2),me=c(n(ye),2);He(me),i(ye);var _e=c(ye,2),Ee=c(n(_e),2);He(Ee),i(_e);var be=c(_e,2),Se=c(n(be),2);Ve(Se),i(be),i(v),i($);var ke=c($,2),de=n(ke);de.__click=[xr,u,_,s,f,y,A,k,p];var ge=c(de,2);ge.__click=[Sr,s,_,f,y,A,k,p,l,u],i(ke),i(ie),Oe(pe,()=>e(_),se=>j(_,se)),Oe(re,()=>e(f),se=>j(f,se)),Oe(ve,()=>e(y),se=>j(y,se)),Oe(Y,()=>e(A),se=>j(A,se)),Oe(Z,()=>e(m),se=>j(m,se)),Oe(ne,()=>e(T),se=>j(T,se)),Oe(B,()=>e(p).cues,se=>Pe(p,e(p).cues=se)),Oe(W,()=>e(p).props,se=>Pe(p,e(p).props=se)),Oe(ee,()=>e(p).costume,se=>Pe(p,e(p).costume=se)),Oe(S,()=>e(p).stage_dressing,se=>Pe(p,e(p).stage_dressing=se)),Oe(me,()=>e(p).chairs,se=>Pe(p,e(p).chairs=se)),Oe(Ee,()=>e(p).stools,se=>Pe(p,e(p).stools=se)),Oe(Se,()=>e(p).other_props,se=>Pe(p,e(p).other_props=se)),F(N,ie)},I=N=>{var ie=Ur(),fe=n(ie),pe=n(fe),te=n(pe,!0);i(pe);var re=c(pe,2);re.__click=[yr,u],i(fe);var z=c(fe,2);{var ve=ee=>{var b=Ir(),S=n(b,!0);i(b),ce(()=>ae(S,s().description)),F(ee,b)};le(z,ee=>{s().description&&ee(ve)})}var G=c(z,2),Y=n(G),E=c(n(Y),2),O=n(E);i(E),i(Y);var Z=c(Y,2),ne=c(n(Z),2),ue=n(ne,!0);i(ne),i(Z);var h=c(Z,2),g=c(n(h),2),$=n(g,!0);i(g),i(h),i(G);var v=c(G,2);{var q=ee=>{var b=Rr(),S=c(n(b),2);Ge(S,5,()=>s().character_performers,tt,(ye,me)=>{var _e=Tr(),Ee=n(_e),be=n(Ee,!0);i(Ee);var Se=c(Ee,2),ke=n(Se,!0);i(Se),i(_e),ce(()=>{ae(be,e(me).character_name),ae(ke,e(me).performer_name)}),F(ye,_e)}),i(S),i(b),F(ee,b)};le(v,ee=>{s().character_performers?.length&&ee(q)})}var B=c(v,2),U=c(n(B),2);{var W=ee=>{var b=Mr(),S=n(b),ye=c(n(S),2);Ve(ye),i(S);var me=c(S,2),_e=c(n(me),2);Ve(_e),i(me);var Ee=c(me,2),be=c(n(Ee),2);Ve(be),i(Ee);var Se=c(Ee,2),ke=c(n(Se),2);Ve(ke),i(Se);var de=c(Se,2),ge=c(n(de),2);He(ge),i(de);var se=c(de,2),Ae=c(n(se),2);He(Ae),i(se);var je=c(se,2),Me=c(n(je),2);Ve(Me),i(je),i(b),Oe(ye,()=>e(p).cues,Ce=>Pe(p,e(p).cues=Ce)),Oe(_e,()=>e(p).props,Ce=>Pe(p,e(p).props=Ce)),Oe(be,()=>e(p).costume,Ce=>Pe(p,e(p).costume=Ce)),Oe(ke,()=>e(p).stage_dressing,Ce=>Pe(p,e(p).stage_dressing=Ce)),Oe(ge,()=>e(p).chairs,Ce=>Pe(p,e(p).chairs=Ce)),Oe(Ae,()=>e(p).stools,Ce=>Pe(p,e(p).stools=Ce)),Oe(Me,()=>e(p).other_props,Ce=>Pe(p,e(p).other_props=Ce)),F(ee,b)},R=(ee,b)=>{{var S=me=>{var _e=Vr(),Ee=n(_e);{var be=xe=>{var De=jr(),$e=c(n(De),2),Le=n($e,!0);i($e),i(De),ce(()=>ae(Le,s().techDetails.cues)),F(xe,De)};le(Ee,xe=>{s().techDetails.cues&&xe(be)})}var Se=c(Ee,2);{var ke=xe=>{var De=zr(),$e=c(n(De),2),Le=n($e,!0);i($e),i(De),ce(()=>ae(Le,s().techDetails.props)),F(xe,De)};le(Se,xe=>{s().techDetails.props&&xe(ke)})}var de=c(Se,2);{var ge=xe=>{var De=Lr(),$e=c(n(De),2),Le=n($e,!0);i($e),i(De),ce(()=>ae(Le,s().techDetails.costume)),F(xe,De)};le(de,xe=>{s().techDetails.costume&&xe(ge)})}var se=c(de,2);{var Ae=xe=>{var De=qr(),$e=c(n(De),2),Le=n($e,!0);i($e),i(De),ce(()=>ae(Le,s().techDetails.stage_dressing)),F(xe,De)};le(se,xe=>{s().techDetails.stage_dressing&&xe(Ae)})}var je=c(se,2);{var Me=xe=>{var De=Fr(),$e=c(n(De),2),Le=n($e,!0);i($e),i(De),ce(dt=>ae(Le,dt),[()=>[s().techDetails.chairs>0?`${s().techDetails.chairs} chair${s().techDetails.chairs!==1?"s":""}`:null,s().techDetails.stools>0?`${s().techDetails.stools} stool${s().techDetails.stools!==1?"s":""}`:null].filter(Boolean).join(", ")],ze),F(xe,De)};le(je,xe=>{(s().techDetails.chairs>0||s().techDetails.stools>0)&&xe(Me)})}var Ce=c(je,2);{var Ke=xe=>{var De=Ar(),$e=c(n(De),2),Le=n($e,!0);i($e),i(De),ce(()=>ae(Le,s().techDetails.other_props)),F(xe,De)};le(Ce,xe=>{s().techDetails.other_props&&xe(Ke)})}i(_e),F(me,_e)},ye=me=>{var _e=Nr();F(me,_e)};le(ee,me=>{s().techDetails?me(S):me(ye,!1)},b)}};le(U,ee=>{e(u)?ee(W):ee(R,!1)})}i(B),i(ie),ce(()=>{ae(te,s().title),ae(O,`${s().duration??""} min`),ae(ue,s().chars),ae($,s().casted)}),F(N,ie)};le(d,N=>{e(u)?N(D):N(I,!1)})}i(x),i(P),i(C),ce(()=>ae(t,s().title)),F(o,C),Re()}Dt(["click","keydown"]);var Wr=X('<div class="detail svelte-u5cezq"><strong>Costume:</strong> </div>'),Kr=X('<span class="differential svelte-u5cezq"> </span>'),Gr=X('<div class="detail svelte-u5cezq"><strong>Stage:</strong> <!></div>'),Jr=X('<div class="detail svelte-u5cezq"><strong>Stage:</strong> <span class="differential svelte-u5cezq"> </span></div>'),Qr=X('<div class="detail svelte-u5cezq"><strong>Cues:</strong> </div>'),Zr=X('<div class="detail svelte-u5cezq"><strong>Props:</strong> </div>'),Yr=X('<div class="tech-details svelte-u5cezq"><!> <!></div>'),Xr=X('<div class="sketch svelte-u5cezq"><div class="sketch-header svelte-u5cezq"><span class="position svelte-u5cezq"> </span> <span class="title svelte-u5cezq"> </span> <span class="duration svelte-u5cezq"> </span></div> <div class="performers svelte-u5cezq"><!></div> <div class="tech-details svelte-u5cezq"><!> <!></div> <!></div>'),ea=X('<div class="print-container svelte-u5cezq"><div class="header svelte-u5cezq"><h1 class="svelte-u5cezq"> </h1> <div class="version-info svelte-u5cezq"><!></div></div> <div class="sketches svelte-u5cezq"></div></div>');function ta(o,r){Te(r,!1);const s=we();let l=he(r,"sketches",8),u=he(r,"showTitle",8),_=he(r,"version",8);function f(P){const x=Math.floor(P/60),w=P%60;return x>0?`${x}h ${w}m`:`${w}m`}function y(P){return(P.character_performers||[]).map(x=>_()==="greenroom"?`<strong>${x.performer_name.toUpperCase()}</strong>`:x.performer_name).join(", ")}function A(P,x){const w={chairs:P.techDetails?.chairs??0,stools:P.techDetails?.stools??0},H=x?{chairs:x.techDetails?.chairs??0,stools:x.techDetails?.stools??0}:{chairs:0,stools:0},L=w.chairs-H.chairs,M=w.stools-H.stools,t=[];return L!==0&&t.push(`${L>0?"+":""}${L} chair${Math.abs(L)!==1?"s":""}`),M!==0&&t.push(`${M>0?"+":""}${M} stool${Math.abs(M)!==1?"s":""}`),t.length>0?`(${t.join(", ")})`:""}it(()=>Qt(l()),()=>{j(s,[...l()].sort((P,x)=>P.position-x.position))}),Ct(),Ne();var m=ea(),T=n(m),k=n(T),p=n(k,!0);i(k);var V=c(k,2),Q=n(V);{var K=P=>{var x=vt("Green Room Version");F(P,x)},J=(P,x)=>{{var w=L=>{var M=vt("Hallway Version");F(L,M)},H=L=>{var M=vt("Tech Booth Version");F(L,M)};le(P,L=>{_()==="hallway"?L(w):L(H,!1)},x)}};le(Q,P=>{_()==="greenroom"?P(K):P(J,!1)})}i(V),i(T);var C=c(T,2);Ge(C,5,()=>e(s),tt,(P,x,w)=>{var H=Xr(),L=n(H),M=n(L),t=n(M);i(M);var a=c(M,2),d=n(a,!0);i(a);var D=c(a,2),I=n(D,!0);i(D),i(L);var N=c(L,2),ie=n(N);or(ie,()=>y(e(x))),i(N);var fe=c(N,2),pe=n(fe);{var te=E=>{var O=Wr(),Z=c(n(O));i(O),ce(()=>ae(Z,` ${e(x).techDetails.costume??""}`)),F(E,O)};le(pe,E=>{(_()==="greenroom"||_()==="hallway")&&e(x).techDetails?.costume&&E(te)})}var re=c(pe,2);{var z=E=>{var O=Gr(),Z=c(n(O)),ne=c(Z);{var ue=h=>{var g=Kr(),$=n(g,!0);i(g),ce(v=>ae($,v),[()=>A(e(x),e(s)[w-1])],ze),F(h,g)};le(ne,h=>{_()==="hallway"&&h(ue)})}i(O),ce(()=>ae(Z,` ${e(x).techDetails.stage_dressing??""} `)),F(E,O)},ve=(E,O)=>{{var Z=ne=>{var ue=Jr(),h=c(n(ue),2),g=n(h,!0);i(h),i(ue),ce($=>ae(g,$),[()=>A(e(x),e(s)[w-1])],ze),F(ne,ue)};le(E,ne=>{_()==="hallway"&&ne(Z)},O)}};le(re,E=>{(_()==="hallway"||_()==="techbooth")&&e(x).techDetails?.stage_dressing?E(z):E(ve,!1)})}i(fe);var G=c(fe,2);{var Y=E=>{var O=Yr(),Z=n(O);{var ne=g=>{var $=Qr(),v=c(n($));i($),ce(()=>ae(v,` ${e(x).techDetails.cues??""}`)),F(g,$)};le(Z,g=>{e(x).techDetails?.cues&&g(ne)})}var ue=c(Z,2);{var h=g=>{var $=Zr(),v=c(n($));i($),ce(()=>ae(v,` ${e(x).techDetails.props??""}`)),F(g,$)};le(ue,g=>{e(x).techDetails?.props&&g(h)})}i(O),F(E,O)};le(G,E=>{_()==="techbooth"&&E(Y)})}i(H),ce(E=>{ae(t,`${e(x).position+1}.`),ae(d,e(x).title),ae(I,E)},[()=>f(e(x).duration)],ze),F(P,H)}),i(C),i(m),ce(()=>ae(p,u())),F(o,m),Re()}var ra=X("<option> </option>"),aa=X('<div class="performer-filter svelte-9vn570"><label for="performer-select" class="svelte-9vn570">Filter by Performer</label> <select id="performer-select" class="svelte-9vn570"><option>All Performers</option><!></select></div>');function Rt(o,r){Te(r,!1);let s=he(r,"performers",24,()=>[]),l=he(r,"selectedPerformer",12,null);const u=Ue();function _(k){const p=k.target,V=p.value===""?null:p.value;l(V),u("select",{performer:V})}Ne();var f=aa(),y=c(n(f),2);Pt(y,()=>l()||"");var A,m=n(y);m.value=m.__value="";var T=c(m);Ge(T,1,s,tt,(k,p)=>{var V=ra(),Q={},K=n(V,!0);i(V),ce(()=>{Q!==(Q=e(p))&&(V.value=(V.__value=e(p))??""),ae(K,e(p))}),F(k,V)}),i(y),i(f),ce(()=>{A!==(A=l()||"")&&(y.value=(y.__value=l()||"")??"",lt(y,l()||""))}),oe("change",y,_),F(o,f),Re()}function sa(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var nt={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var ia=nt.exports,wt;function na(){return wt||(wt=1,function(o,r){((s,l)=>{o.exports=l()})(ia,function s(){var l=typeof self<"u"?self:typeof window<"u"?window:l!==void 0?l:{},u,_=!l.document&&!!l.postMessage,f=l.IS_PAPA_WORKER||!1,y={},A=0,m={};function T(t){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(a){var d=H(a);d.chunkSize=parseInt(d.chunkSize),a.step||a.chunk||(d.chunkSize=null),this._handle=new K(d),(this._handle.streamer=this)._config=d}.call(this,t),this.parseChunk=function(a,d){var D=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<D){let N=this._config.newline;N||(I=this._config.quoteChar||'"',N=this._handle.guessLineEndings(a,I)),a=[...a.split(N).slice(D)].join(N)}this.isFirstChunk&&M(this._config.beforeFirstChunk)&&(I=this._config.beforeFirstChunk(a))!==void 0&&(a=I),this.isFirstChunk=!1,this._halted=!1;var D=this._partialLine+a,I=(this._partialLine="",this._handle.parse(D,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(a=I.meta.cursor,D=(this._finished||(this._partialLine=D.substring(a-this._baseIndex),this._baseIndex=a),I&&I.data&&(this._rowCount+=I.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),f)l.postMessage({results:I,workerId:m.WORKER_ID,finished:D});else if(M(this._config.chunk)&&!d){if(this._config.chunk(I,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=I=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(I.data),this._completeResults.errors=this._completeResults.errors.concat(I.errors),this._completeResults.meta=I.meta),this._completed||!D||!M(this._config.complete)||I&&I.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),D||I&&I.meta.paused||this._nextChunk(),I}this._halted=!0},this._sendError=function(a){M(this._config.error)?this._config.error(a):f&&this._config.error&&l.postMessage({workerId:m.WORKER_ID,error:a,finished:!1})}}function k(t){var a;(t=t||{}).chunkSize||(t.chunkSize=m.RemoteChunkSize),T.call(this,t),this._nextChunk=_?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(d){this._input=d,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(a=new XMLHttpRequest,this._config.withCredentials&&(a.withCredentials=this._config.withCredentials),_||(a.onload=L(this._chunkLoaded,this),a.onerror=L(this._chunkError,this)),a.open(this._config.downloadRequestBody?"POST":"GET",this._input,!_),this._config.downloadRequestHeaders){var d,D=this._config.downloadRequestHeaders;for(d in D)a.setRequestHeader(d,D[d])}var I;this._config.chunkSize&&(I=this._start+this._config.chunkSize-1,a.setRequestHeader("Range","bytes="+this._start+"-"+I));try{a.send(this._config.downloadRequestBody)}catch(N){this._chunkError(N.message)}_&&a.status===0&&this._chunkError()}},this._chunkLoaded=function(){a.readyState===4&&(a.status<200||400<=a.status?this._chunkError():(this._start+=this._config.chunkSize||a.responseText.length,this._finished=!this._config.chunkSize||this._start>=(d=>(d=d.getResponseHeader("Content-Range"))!==null?parseInt(d.substring(d.lastIndexOf("/")+1)):-1)(a),this.parseChunk(a.responseText)))},this._chunkError=function(d){d=a.statusText||d,this._sendError(new Error(d))}}function p(t){(t=t||{}).chunkSize||(t.chunkSize=m.LocalChunkSize),T.call(this,t);var a,d,D=typeof FileReader<"u";this.stream=function(I){this._input=I,d=I.slice||I.webkitSlice||I.mozSlice,D?((a=new FileReader).onload=L(this._chunkLoaded,this),a.onerror=L(this._chunkError,this)):a=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var I=this._input,N=(this._config.chunkSize&&(N=Math.min(this._start+this._config.chunkSize,this._input.size),I=d.call(I,this._start,N)),a.readAsText(I,this._config.encoding));D||this._chunkLoaded({target:{result:N}})},this._chunkLoaded=function(I){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(I.target.result)},this._chunkError=function(){this._sendError(a.error)}}function V(t){var a;T.call(this,t=t||{}),this.stream=function(d){return a=d,this._nextChunk()},this._nextChunk=function(){var d,D;if(!this._finished)return d=this._config.chunkSize,a=d?(D=a.substring(0,d),a.substring(d)):(D=a,""),this._finished=!a,this.parseChunk(D)}}function Q(t){T.call(this,t=t||{});var a=[],d=!0,D=!1;this.pause=function(){T.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){T.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(I){this._input=I,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){D&&a.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),a.length?this.parseChunk(a.shift()):d=!0},this._streamData=L(function(I){try{a.push(typeof I=="string"?I:I.toString(this._config.encoding)),d&&(d=!1,this._checkIsFinished(),this.parseChunk(a.shift()))}catch(N){this._streamError(N)}},this),this._streamError=L(function(I){this._streamCleanUp(),this._sendError(I)},this),this._streamEnd=L(function(){this._streamCleanUp(),D=!0,this._streamData("")},this),this._streamCleanUp=L(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function K(t){var a,d,D,I,N=Math.pow(2,53),ie=-N,fe=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,pe=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,te=this,re=0,z=0,ve=!1,G=!1,Y=[],E={data:[],errors:[],meta:{}};function O(h){return t.skipEmptyLines==="greedy"?h.join("").trim()==="":h.length===1&&h[0].length===0}function Z(){if(E&&D&&(ue("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+m.DefaultDelimiter+"'"),D=!1),t.skipEmptyLines&&(E.data=E.data.filter(function(v){return!O(v)})),ne()){let v=function(q,B){M(t.transformHeader)&&(q=t.transformHeader(q,B)),Y.push(q)};if(E)if(Array.isArray(E.data[0])){for(var h=0;ne()&&h<E.data.length;h++)E.data[h].forEach(v);E.data.splice(0,1)}else E.data.forEach(v)}function g(v,q){for(var B=t.header?{}:[],U=0;U<v.length;U++){var W=U,R=v[U],R=((ee,b)=>(S=>(t.dynamicTypingFunction&&t.dynamicTyping[S]===void 0&&(t.dynamicTyping[S]=t.dynamicTypingFunction(S)),(t.dynamicTyping[S]||t.dynamicTyping)===!0))(ee)?b==="true"||b==="TRUE"||b!=="false"&&b!=="FALSE"&&((S=>{if(fe.test(S)&&(S=parseFloat(S),ie<S&&S<N))return 1})(b)?parseFloat(b):pe.test(b)?new Date(b):b===""?null:b):b)(W=t.header?U>=Y.length?"__parsed_extra":Y[U]:W,R=t.transform?t.transform(R,W):R);W==="__parsed_extra"?(B[W]=B[W]||[],B[W].push(R)):B[W]=R}return t.header&&(U>Y.length?ue("FieldMismatch","TooManyFields","Too many fields: expected "+Y.length+" fields but parsed "+U,z+q):U<Y.length&&ue("FieldMismatch","TooFewFields","Too few fields: expected "+Y.length+" fields but parsed "+U,z+q)),B}var $;E&&(t.header||t.dynamicTyping||t.transform)&&($=1,!E.data.length||Array.isArray(E.data[0])?(E.data=E.data.map(g),$=E.data.length):E.data=g(E.data,0),t.header&&E.meta&&(E.meta.fields=Y),z+=$)}function ne(){return t.header&&Y.length===0}function ue(h,g,$,v){h={type:h,code:g,message:$},v!==void 0&&(h.row=v),E.errors.push(h)}M(t.step)&&(I=t.step,t.step=function(h){E=h,ne()?Z():(Z(),E.data.length!==0&&(re+=h.data.length,t.preview&&re>t.preview?d.abort():(E.data=E.data[0],I(E,te))))}),this.parse=function(h,g,$){var v=t.quoteChar||'"',v=(t.newline||(t.newline=this.guessLineEndings(h,v)),D=!1,t.delimiter?M(t.delimiter)&&(t.delimiter=t.delimiter(h),E.meta.delimiter=t.delimiter):((v=((q,B,U,W,R)=>{var ee,b,S,ye;R=R||[",","	","|",";",m.RECORD_SEP,m.UNIT_SEP];for(var me=0;me<R.length;me++){for(var _e,Ee=R[me],be=0,Se=0,ke=0,de=(S=void 0,new C({comments:W,delimiter:Ee,newline:B,preview:10}).parse(q)),ge=0;ge<de.data.length;ge++)U&&O(de.data[ge])?ke++:(_e=de.data[ge].length,Se+=_e,S===void 0?S=_e:0<_e&&(be+=Math.abs(_e-S),S=_e));0<de.data.length&&(Se/=de.data.length-ke),(b===void 0||be<=b)&&(ye===void 0||ye<Se)&&1.99<Se&&(b=be,ee=Ee,ye=Se)}return{successful:!!(t.delimiter=ee),bestDelimiter:ee}})(h,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess)).successful?t.delimiter=v.bestDelimiter:(D=!0,t.delimiter=m.DefaultDelimiter),E.meta.delimiter=t.delimiter),H(t));return t.preview&&t.header&&v.preview++,a=h,d=new C(v),E=d.parse(a,g,$),Z(),ve?{meta:{paused:!0}}:E||{meta:{paused:!1}}},this.paused=function(){return ve},this.pause=function(){ve=!0,d.abort(),a=M(t.chunk)?"":a.substring(d.getCharIndex())},this.resume=function(){te.streamer._halted?(ve=!1,te.streamer.parseChunk(a,!0)):setTimeout(te.resume,3)},this.aborted=function(){return G},this.abort=function(){G=!0,d.abort(),E.meta.aborted=!0,M(t.complete)&&t.complete(E),a=""},this.guessLineEndings=function(q,v){q=q.substring(0,1048576);var v=new RegExp(J(v)+"([^]*?)"+J(v),"gm"),$=(q=q.replace(v,"")).split("\r"),v=q.split(`
`),q=1<v.length&&v[0].length<$[0].length;if($.length===1||q)return`
`;for(var B=0,U=0;U<$.length;U++)$[U][0]===`
`&&B++;return B>=$.length/2?`\r
`:"\r"}}function J(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function C(t){var a=(t=t||{}).delimiter,d=t.newline,D=t.comments,I=t.step,N=t.preview,ie=t.fastMode,fe=null,pe=!1,te=t.quoteChar==null?'"':t.quoteChar,re=te;if(t.escapeChar!==void 0&&(re=t.escapeChar),(typeof a!="string"||-1<m.BAD_DELIMITERS.indexOf(a))&&(a=","),D===a)throw new Error("Comment character same as delimiter");D===!0?D="#":(typeof D!="string"||-1<m.BAD_DELIMITERS.indexOf(D))&&(D=!1),d!==`
`&&d!=="\r"&&d!==`\r
`&&(d=`
`);var z=0,ve=!1;this.parse=function(G,Y,E){if(typeof G!="string")throw new Error("Input must be a string");var O=G.length,Z=a.length,ne=d.length,ue=D.length,h=M(I),g=[],$=[],v=[],q=z=0;if(!G)return be();if(ie||ie!==!1&&G.indexOf(te)===-1){for(var B=G.split(d),U=0;U<B.length;U++){if(v=B[U],z+=v.length,U!==B.length-1)z+=d.length;else if(E)return be();if(!D||v.substring(0,ue)!==D){if(h){if(g=[],ye(v.split(a)),Se(),ve)return be()}else ye(v.split(a));if(N&&N<=U)return g=g.slice(0,N),be(!0)}}return be()}for(var W=G.indexOf(a,z),R=G.indexOf(d,z),ee=new RegExp(J(re)+J(te),"g"),b=G.indexOf(te,z);;)if(G[z]===te)for(b=z,z++;;){if((b=G.indexOf(te,b+1))===-1)return E||$.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:g.length,index:z}),_e();if(b===O-1)return _e(G.substring(z,b).replace(ee,te));if(te===re&&G[b+1]===re)b++;else if(te===re||b===0||G[b-1]!==re){W!==-1&&W<b+1&&(W=G.indexOf(a,b+1));var S=me((R=R!==-1&&R<b+1?G.indexOf(d,b+1):R)===-1?W:Math.min(W,R));if(G.substr(b+1+S,Z)===a){v.push(G.substring(z,b).replace(ee,te)),G[z=b+1+S+Z]!==te&&(b=G.indexOf(te,z)),W=G.indexOf(a,z),R=G.indexOf(d,z);break}if(S=me(R),G.substring(b+1+S,b+1+S+ne)===d){if(v.push(G.substring(z,b).replace(ee,te)),Ee(b+1+S+ne),W=G.indexOf(a,z),b=G.indexOf(te,z),h&&(Se(),ve))return be();if(N&&g.length>=N)return be(!0);break}$.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:g.length,index:z}),b++}}else if(D&&v.length===0&&G.substring(z,z+ue)===D){if(R===-1)return be();z=R+ne,R=G.indexOf(d,z),W=G.indexOf(a,z)}else if(W!==-1&&(W<R||R===-1))v.push(G.substring(z,W)),z=W+Z,W=G.indexOf(a,z);else{if(R===-1)break;if(v.push(G.substring(z,R)),Ee(R+ne),h&&(Se(),ve))return be();if(N&&g.length>=N)return be(!0)}return _e();function ye(ke){g.push(ke),q=z}function me(ke){var de=0;return de=ke!==-1&&(ke=G.substring(b+1,ke))&&ke.trim()===""?ke.length:de}function _e(ke){return E||(ke===void 0&&(ke=G.substring(z)),v.push(ke),z=O,ye(v),h&&Se()),be()}function Ee(ke){z=ke,ye(v),v=[],R=G.indexOf(d,z)}function be(ke){if(t.header&&!Y&&g.length&&!pe){var de=g[0],ge=Object.create(null),se=new Set(de);let Ae=!1;for(let je=0;je<de.length;je++){let Me=de[je];if(ge[Me=M(t.transformHeader)?t.transformHeader(Me,je):Me]){let Ce,Ke=ge[Me];for(;Ce=Me+"_"+Ke,Ke++,se.has(Ce););se.add(Ce),de[je]=Ce,ge[Me]++,Ae=!0,(fe=fe===null?{}:fe)[Ce]=Me}else ge[Me]=1,de[je]=Me;se.add(Me)}Ae&&console.warn("Duplicate headers found and renamed."),pe=!0}return{data:g,errors:$,meta:{delimiter:a,linebreak:d,aborted:ve,truncated:!!ke,cursor:q+(Y||0),renamedHeaders:fe}}}function Se(){I(be()),g=[],$=[]}},this.abort=function(){ve=!0},this.getCharIndex=function(){return z}}function P(t){var a=t.data,d=y[a.workerId],D=!1;if(a.error)d.userError(a.error,a.file);else if(a.results&&a.results.data){var I={abort:function(){D=!0,x(a.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:w,resume:w};if(M(d.userStep)){for(var N=0;N<a.results.data.length&&(d.userStep({data:a.results.data[N],errors:a.results.errors,meta:a.results.meta},I),!D);N++);delete a.results}else M(d.userChunk)&&(d.userChunk(a.results,I,a.file),delete a.results)}a.finished&&!D&&x(a.workerId,a.results)}function x(t,a){var d=y[t];M(d.userComplete)&&d.userComplete(a),d.terminate(),delete y[t]}function w(){throw new Error("Not implemented.")}function H(t){if(typeof t!="object"||t===null)return t;var a,d=Array.isArray(t)?[]:{};for(a in t)d[a]=H(t[a]);return d}function L(t,a){return function(){t.apply(a,arguments)}}function M(t){return typeof t=="function"}return m.parse=function(t,a){var d=(a=a||{}).dynamicTyping||!1;if(M(d)&&(a.dynamicTypingFunction=d,d={}),a.dynamicTyping=d,a.transform=!!M(a.transform)&&a.transform,!a.worker||!m.WORKERS_SUPPORTED)return d=null,m.NODE_STREAM_INPUT,typeof t=="string"?(t=(D=>D.charCodeAt(0)!==65279?D:D.slice(1))(t),d=new(a.download?k:V)(a)):t.readable===!0&&M(t.read)&&M(t.on)?d=new Q(a):(l.File&&t instanceof File||t instanceof Object)&&(d=new p(a)),d.stream(t);(d=(()=>{var D;return!!m.WORKERS_SUPPORTED&&(D=(()=>{var I=l.URL||l.webkitURL||null,N=s.toString();return m.BLOB_URL||(m.BLOB_URL=I.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",N,")();"],{type:"text/javascript"})))})(),(D=new l.Worker(D)).onmessage=P,D.id=A++,y[D.id]=D)})()).userStep=a.step,d.userChunk=a.chunk,d.userComplete=a.complete,d.userError=a.error,a.step=M(a.step),a.chunk=M(a.chunk),a.complete=M(a.complete),a.error=M(a.error),delete a.worker,d.postMessage({input:t,config:a,workerId:d.id})},m.unparse=function(t,a){var d=!1,D=!0,I=",",N=`\r
`,ie='"',fe=ie+ie,pe=!1,te=null,re=!1,z=((()=>{if(typeof a=="object"){if(typeof a.delimiter!="string"||m.BAD_DELIMITERS.filter(function(Y){return a.delimiter.indexOf(Y)!==-1}).length||(I=a.delimiter),typeof a.quotes!="boolean"&&typeof a.quotes!="function"&&!Array.isArray(a.quotes)||(d=a.quotes),typeof a.skipEmptyLines!="boolean"&&typeof a.skipEmptyLines!="string"||(pe=a.skipEmptyLines),typeof a.newline=="string"&&(N=a.newline),typeof a.quoteChar=="string"&&(ie=a.quoteChar),typeof a.header=="boolean"&&(D=a.header),Array.isArray(a.columns)){if(a.columns.length===0)throw new Error("Option columns is empty");te=a.columns}a.escapeChar!==void 0&&(fe=a.escapeChar+ie),a.escapeFormulae instanceof RegExp?re=a.escapeFormulae:typeof a.escapeFormulae=="boolean"&&a.escapeFormulae&&(re=/^[=+\-@\t\r].*$/)}})(),new RegExp(J(ie),"g"));if(typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return ve(null,t,pe);if(typeof t[0]=="object")return ve(te||Object.keys(t[0]),t,pe)}else if(typeof t=="object")return typeof t.data=="string"&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields||te),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:typeof t.data[0]=="object"?Object.keys(t.data[0]):[]),Array.isArray(t.data[0])||typeof t.data[0]=="object"||(t.data=[t.data])),ve(t.fields||[],t.data||[],pe);throw new Error("Unable to serialize unrecognized input");function ve(Y,E,O){var Z="",ne=(typeof Y=="string"&&(Y=JSON.parse(Y)),typeof E=="string"&&(E=JSON.parse(E)),Array.isArray(Y)&&0<Y.length),ue=!Array.isArray(E[0]);if(ne&&D){for(var h=0;h<Y.length;h++)0<h&&(Z+=I),Z+=G(Y[h],h);0<E.length&&(Z+=N)}for(var g=0;g<E.length;g++){var $=(ne?Y:E[g]).length,v=!1,q=ne?Object.keys(E[g]).length===0:E[g].length===0;if(O&&!ne&&(v=O==="greedy"?E[g].join("").trim()==="":E[g].length===1&&E[g][0].length===0),O==="greedy"&&ne){for(var B=[],U=0;U<$;U++){var W=ue?Y[U]:U;B.push(E[g][W])}v=B.join("").trim()===""}if(!v){for(var R=0;R<$;R++){0<R&&!q&&(Z+=I);var ee=ne&&ue?Y[R]:R;Z+=G(E[g][ee],R)}g<E.length-1&&(!O||0<$&&!q)&&(Z+=N)}}return Z}function G(Y,E){var O,Z;return Y==null?"":Y.constructor===Date?JSON.stringify(Y).slice(1,25):(Z=!1,re&&typeof Y=="string"&&re.test(Y)&&(Y="'"+Y,Z=!0),O=Y.toString().replace(z,fe),(Z=Z||d===!0||typeof d=="function"&&d(Y,E)||Array.isArray(d)&&d[E]||((ne,ue)=>{for(var h=0;h<ue.length;h++)if(-1<ne.indexOf(ue[h]))return!0;return!1})(O,m.BAD_DELIMITERS)||-1<O.indexOf(I)||O.charAt(0)===" "||O.charAt(O.length-1)===" ")?ie+O+ie:O)}},m.RECORD_SEP="",m.UNIT_SEP="",m.BYTE_ORDER_MARK="\uFEFF",m.BAD_DELIMITERS=["\r",`
`,'"',m.BYTE_ORDER_MARK],m.WORKERS_SUPPORTED=!_&&!!l.Worker,m.NODE_STREAM_INPUT=1,m.LocalChunkSize=10485760,m.RemoteChunkSize=5242880,m.DefaultDelimiter=",",m.Parser=C,m.ParserHandle=K,m.NetworkStreamer=k,m.FileStreamer=p,m.StringStreamer=V,m.ReadableStreamStreamer=Q,l.jQuery&&((u=l.jQuery).fn.parse=function(t){var a=t.config||{},d=[];return this.each(function(N){if(!(u(this).prop("tagName").toUpperCase()==="INPUT"&&u(this).attr("type").toLowerCase()==="file"&&l.FileReader)||!this.files||this.files.length===0)return!0;for(var ie=0;ie<this.files.length;ie++)d.push({file:this.files[ie],inputElem:this,instanceConfig:u.extend({},a)})}),D(),this;function D(){if(d.length===0)M(t.complete)&&t.complete();else{var N,ie,fe,pe,te=d[0];if(M(t.before)){var re=t.before(te.file,te.inputElem);if(typeof re=="object"){if(re.action==="abort")return N="AbortError",ie=te.file,fe=te.inputElem,pe=re.reason,void(M(t.error)&&t.error({name:N},ie,fe,pe));if(re.action==="skip")return void I();typeof re.config=="object"&&(te.instanceConfig=u.extend(te.instanceConfig,re.config))}else if(re==="skip")return void I()}var z=te.instanceConfig.complete;te.instanceConfig.complete=function(ve){M(z)&&z(ve,te.file,te.inputElem),I()},m.parse(te.file,te.instanceConfig)}}function I(){d.splice(0,1),D()}}),f&&(l.onmessage=function(t){t=t.data,m.WORKER_ID===void 0&&t&&(m.WORKER_ID=t.workerId),typeof t.input=="string"?l.postMessage({workerId:m.WORKER_ID,results:m.parse(t.input,t.config),finished:!0}):(l.File&&t.input instanceof File||t.input instanceof Object)&&(t=m.parse(t.input,t.config))&&l.postMessage({workerId:m.WORKER_ID,results:t,finished:!0})}),(k.prototype=Object.create(T.prototype)).constructor=k,(p.prototype=Object.create(T.prototype)).constructor=p,(V.prototype=Object.create(V.prototype)).constructor=V,(Q.prototype=Object.create(T.prototype)).constructor=Q,m})}(nt)),nt.exports}var oa=na();const la=sa(oa);function ca(o){const r=la.parse(o,{header:!0,skipEmptyLines:!0,transformHeader:s=>s.trim().toLowerCase(),dynamicTyping:!1,transform:s=>s.trim()});return r.errors.length>0?(console.error("CSV Parsing Errors with Papaparse:",r.errors),r.data.filter(l=>l&&typeof l=="object"&&Object.keys(l).length>0)):r.data.filter(s=>s&&typeof s=="object"&&Object.keys(s).length>0)}function da(o){const r={},s=["total","actors","chars/actor","min number","people with extra"];return o.forEach(l=>{const u=l.title?.trim(),_=parseInt(l.chars||"",10);if(!u||s.includes(u.toLowerCase())||isNaN(_)||_<=0)return;const f=[],y=Object.keys(l),A=y.findIndex(V=>V.toLowerCase()==="casted");if(console.log(`Processing sketch "${u}":`,{castedIndex:A,columns:y}),A!==-1)for(let V=A+1;V<y.length;V++){const Q=y[V].trim(),K=l[y[V]]?.trim();Q&&K&&(console.log("Found character-performer pair:",{performerName:Q,characterName:K}),f.push({character_name:K,performer_name:Q}))}const m=l.time||l.duration||"5:00",[T,k]=m.split(":").map(Number),p=T+(k||0)/60;r[u]={id:crypto.randomUUID(),title:u,description:l.description||"",duration:Math.ceil(p),chars:parseInt(l.chars||"0",10),casted:f.length,locked:!1,character_performers:f.map(V=>({character_name:V.character_name,performer_name:V.performer_name})),raw_data:l}}),console.log("Processed sketches with character performers:",Object.values(r).map(l=>({title:l.title,character_performers:l.character_performers}))),Object.values(r)}async function va(o){return new Promise((r,s)=>{const l=new FileReader;l.onload=u=>{try{const _=u.target?.result,f=ca(_);r(f)}catch(_){s(_)}},l.onerror=()=>s(l.error),l.readAsText(o)})}var ua=X('<div><h2 class="text-lg font-medium text-gray-900 mb-4">Import Running Order</h2> <div class="space-y-6"><div class="flex items-center justify-center w-full"><label for="csv-file" class="flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100"><div class="flex flex-col items-center justify-center pt-5 pb-6"><svg class="w-8 h-8 mb-4 text-gray-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 16"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"></path></svg> <p class="mb-2 text-sm text-gray-500"><span class="font-semibold">Click to upload</span> or drag and drop</p> <p class="text-xs text-gray-500">CSV files only</p></div> <input id="csv-file" type="file" accept=".csv" class="hidden"/></label></div> <button type="button" class="w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 mt-2">Upload CSV</button></div></div>');function ha(o,r){Te(r,!1),he(r,"showId",8);const s=Ue();let l=we(),u=we(!1);function _(C){const P=C.map(a=>a.toLowerCase().trim());if(["sketch","cues","props","costume","stage dressing"].every(a=>P.includes(a)))return"techDetails";const H=["title"],L=["time","chars","casted","rocio","jacob","adrian","vera","max","gusta","richie","harry","connor","kieran","chiara","lari","theresa","cliff","tim"],M=H.every(a=>P.includes(a)),t=L.some(a=>P.includes(a));return M&&t?"sketches":"unknown"}async function f(){const C=e(l).files;if(!(!C||C.length===0))try{const P=C[0],x=await va(P);if(!x||x.length===0){alert("CSV file is empty or could not be processed."),Pe(l,e(l).value="");return}const w=Object.keys(x[0]),H=_(w);if(H==="unknown"){alert('Could not automatically determine CSV type. Please check the file headers and format. Expected headers for sketches: "title" and at least one of "Time", "chars", etc. Expected headers for tech details: "Sketch", "Cues", "Props", "Costume", "Stage Dressing".'),Pe(l,e(l).value="");return}let L;H==="sketches"?L=da(x):L=x,s("import",{importType:H,data:L}),Pe(l,e(l).value="")}catch(P){console.error("Error importing CSV:",P),alert("Error importing CSV file. Please check the file format and content."),Pe(l,e(l).value="")}}function y(C){C.preventDefault(),j(u,!0)}function A(C){C.preventDefault(),j(u,!1)}function m(C){C.preventDefault(),j(u,!1);const P=C.dataTransfer?.files;P&&P.length>0&&(Pe(l,e(l).files=P),f())}Ne();var T=ua();let k;var p=c(n(T),2),V=n(p),Q=n(V),K=c(n(Q),2);nr(K,C=>j(l,C),()=>e(l)),i(Q),i(V);var J=c(V,2);J.__click=f,i(p),i(T),ce(C=>k=Ie(T,1,"bg-white p-6 rounded-lg shadow-sm",null,k,C),[()=>({"border-2":e(u),"border-dashed":e(u),"border-blue-500":e(u)})],ze),oe("dragover",T,C=>y(C)),oe("dragleave",T,C=>A(C)),oe("drop",T,C=>m(C)),F(o,T),Re()}Dt(["click"]);const fa=o=>o;function pa(o){const r=o-1;return r*r*r+1}function _a(o,{delay:r=0,duration:s=400,easing:l=fa}={}){const u=+getComputedStyle(o).opacity;return{delay:r,duration:s,easing:l,css:_=>`opacity: ${_*u}`}}function ga(o,{delay:r=0,duration:s=400,easing:l=pa,axis:u="y"}={}){const _=getComputedStyle(o),f=+_.opacity,y=u==="y"?"height":"width",A=parseFloat(_[y]),m=u==="y"?["top","bottom"]:["left","right"],T=m.map(C=>`${C[0].toUpperCase()}${C.slice(1)}`),k=parseFloat(_[`padding${T[0]}`]),p=parseFloat(_[`padding${T[1]}`]),V=parseFloat(_[`margin${T[0]}`]),Q=parseFloat(_[`margin${T[1]}`]),K=parseFloat(_[`border${T[0]}Width`]),J=parseFloat(_[`border${T[1]}Width`]);return{delay:r,duration:s,easing:l,css:C=>`overflow: hidden;opacity: ${Math.min(C*20,1)*f};${y}: ${C*A}px;padding-${m[0]}: ${C*k}px;padding-${m[1]}: ${C*p}px;margin-${m[0]}: ${C*V}px;margin-${m[1]}: ${C*Q}px;border-${m[0]}-width: ${C*K}px;border-${m[1]}-width: ${C*J}px;min-${y}: 0`}}var ma=X("<button> </button>"),ka=X('<div class="filter-dropdown svelte-uawkgq"><button>All Performers</button> <!></div>'),ba=X('<div class="collapsed-buttons svelte-uawkgq"><button class="sidebar-button svelte-uawkgq" title="Print Set List"><!></button> <div class="filter-container svelte-uawkgq"><button class="sidebar-button svelte-uawkgq" title="Filter by Performer"><!></button> <!></div> <button class="sidebar-button svelte-uawkgq" title="Import CSV"><!></button></div>'),wa=X('<div><button class="sidebar-button collapse-button svelte-uawkgq"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"></path></svg></button> <div class="sidebar-header svelte-uawkgq"><h1 class="svelte-uawkgq"> </h1> <div class="print-controls svelte-uawkgq"><select class="svelte-uawkgq"><option>Green Room Version</option><option>Hallway Version</option><option>Tech Booth Version</option></select> <button class="print-button svelte-uawkgq">Print Set List</button></div></div> <div class="sidebar-content svelte-uawkgq"><!> <div class="mt-4"><!></div></div> <!></div>');function ya(o,r){Te(r,!1);let s=he(r,"show",8),l=he(r,"performers",8),u=he(r,"selectedPerformer",12,null),_=he(r,"printVersion",12,"greenroom"),f=he(r,"isSidebarCollapsed",12,!1);const y=Ue();let A=we(!1);function m(){f(!f()),y("collapse",{collapsed:f()})}function T(){j(A,!e(A))}function k(re){y("filter",{performer:re}),j(A,!1)}function p(){y("print",{printVersion:_()})}function V(re){y("csvImport",re.detail)}Ne();var Q=wa();let K;var J=n(Q),C=n(J);let P;i(J);var x=c(J,2),w=n(x),H=n(w,!0);i(w);var L=c(w,2),M=n(L);ce(()=>{_(),Zt(()=>{})});var t=n(M);t.value=t.__value="greenroom";var a=c(t);a.value=a.__value="hallway";var d=c(a);d.value=d.__value="techbooth",i(M);var D=c(M,2);i(L),i(x);var I=c(x,2),N=n(I);Rt(N,{get performers(){return l()},get selectedPerformer(){return u()},set selectedPerformer(re){u(re)},$$legacy:!0});var ie=c(N,2),fe=n(ie);ha(fe,{get showId(){return s().id},$$events:{import:V,importComplete:()=>y("importComplete")}}),i(ie),i(I);var pe=c(I,2);{var te=re=>{var z=ba(),ve=n(z),G=n(ve);It(G,{size:20}),i(ve);var Y=c(ve,2),E=n(Y),O=n(E);pr(O,{size:20}),i(E);var Z=c(E,2);{var ne=g=>{var $=ka(),v=n($);let q;var B=c(v,2);Ge(B,1,l,tt,(U,W)=>{var R=ma();let ee;var b=n(R,!0);i(R),ce(S=>{ee=Ie(R,1,"filter-option svelte-uawkgq",null,ee,S),ae(b,e(W))},[()=>({active:u()===e(W)})],ze),oe("click",R,()=>k(e(W))),F(U,R)}),i($),ce(U=>q=Ie(v,1,"filter-option svelte-uawkgq",null,q,U),[()=>({active:u()===null})],ze),oe("click",v,()=>k(null)),Ot(3,$,()=>_a),F(g,$)};le(Z,g=>{e(A)&&g(ne)})}i(Y);var ue=c(Y,2),h=n(ue);mr(h,{size:20}),i(ue),i(z),oe("click",ve,p),oe("click",E,T),oe("click",ue,()=>{document.querySelector('input[type="file"]')?.click()}),F(re,z)};le(pe,re=>{f()&&re(te)})}i(Q),ce((re,z)=>{K=Ie(Q,1,"sidebar svelte-uawkgq",null,K,re),qe(J,"aria-label",f()?"Expand sidebar":"Collapse sidebar"),P=Ie(C,0,"arrow-icon svelte-uawkgq",null,P,z),ae(H,s().title)},[()=>({collapsed:f()}),()=>({collapsed:f()})],ze),oe("click",J,m),ur(M,_),oe("click",D,p),F(o,Q),Re()}var xa=X('<div class="view-controls svelte-xwc4id"><div class="view-buttons svelte-xwc4id"><button aria-label="Grid view"><!></button> <button aria-label="List view"><!></button></div> <div class="action-buttons svelte-xwc4id"><button class="optimize-button svelte-xwc4id" aria-label="Optimize running order" title="Optimize running order to minimize cast conflicts"><!> <span>Optimize</span></button> <div class="print-buttons svelte-xwc4id"><button>Green Room</button> <button>Hallway</button> <button>Tech Booth</button></div></div></div>');function Sa(o,r){Te(r,!1);let s=he(r,"viewMode",12,"list"),l=he(r,"printVersion",12,"greenroom"),u=he(r,"showPrintView",8,!1);const _=Ue();function f(D){s(D),_("viewModeChange",{viewMode:D})}function y(D){l(D),_("printVersionChange",{printVersion:D}),_("showPrintViewChange",{showPrintView:!0})}function A(){_("optimize")}Ne();var m=xa(),T=n(m),k=n(T);let p;var V=n(k);_r(V,{size:20}),i(k);var Q=c(k,2);let K;var J=n(Q);gr(J,{size:20}),i(Q),i(T);var C=c(T,2),P=n(C),x=n(P);kr(x,{size:20}),Yt(2),i(P);var w=c(P,2),H=n(w);let L;var M=c(H,2);let t;var a=c(M,2);let d;i(w),i(C),i(m),ce((D,I,N,ie,fe)=>{p=Ie(k,1,"view-button svelte-xwc4id",null,p,D),K=Ie(Q,1,"view-button svelte-xwc4id",null,K,I),L=Ie(H,1,"print-view-button svelte-xwc4id",null,L,N),t=Ie(M,1,"print-view-button svelte-xwc4id",null,t,ie),d=Ie(a,1,"print-view-button svelte-xwc4id",null,d,fe)},[()=>({active:s()==="grid"}),()=>({active:s()==="list"}),()=>({active:u()&&l()==="greenroom"}),()=>({active:u()&&l()==="hallway"}),()=>({active:u()&&l()==="techbooth"})],ze),oe("click",k,()=>f("grid")),oe("click",Q,()=>f("list")),oe("click",P,A),oe("click",H,()=>y("greenroom")),oe("click",M,()=>y("hallway")),oe("click",a,()=>y("techbooth")),F(o,m),Re()}function Ca(o){const r=o-1;return r*r*r+1}function Mt(o,{from:r,to:s},l={}){var{delay:u=0,duration:_=L=>Math.sqrt(L)*120,easing:f=Ca}=l,y=getComputedStyle(o),A=y.transform==="none"?"":y.transform,[m,T]=y.transformOrigin.split(" ").map(parseFloat);m/=o.clientWidth,T/=o.clientHeight;var k=Da(o),p=o.clientWidth/s.width/k,V=o.clientHeight/s.height/k,Q=r.left+r.width*m,K=r.top+r.height*T,J=s.left+s.width*m,C=s.top+s.height*T,P=(Q-J)*p,x=(K-C)*V,w=r.width/s.width,H=r.height/s.height;return{delay:u,duration:typeof _=="function"?_(Math.sqrt(P*P+x*x)):_,easing:f,css:(L,M)=>{var t=M*P,a=M*x,d=L+M*w,D=L+M*H;return`transform: ${A} translate(${t}px, ${a}px) scale(${d}, ${D});`}}}function Da(o){if("currentCSSZoom"in o)return o.currentCSSZoom;for(var r=o,s=1;r!==null;)s*=+getComputedStyle(r).zoom,r=r.parentElement;return s}var Ea=ct('<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z" clip-rule="evenodd"></path></svg>'),$a=ct('<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 11V7a4 4 0 118 0m-4 8v3m-6 2h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"></path></svg>'),Oa=X('<span class="character-count svelte-t9pjlk"> </span>'),Pa=X('<div class="description svelte-t9pjlk"><strong>Description:</strong> </div>'),Ia=X('<div class="detail svelte-t9pjlk"><strong class="svelte-t9pjlk">Costume:</strong> </div>'),Ta=X('<div class="detail svelte-t9pjlk"><strong class="svelte-t9pjlk">Stage:</strong> </div>'),Ra=X('<div class="detail svelte-t9pjlk"><strong class="svelte-t9pjlk">Cues:</strong> </div>'),Ma=X('<div class="detail svelte-t9pjlk"><strong class="svelte-t9pjlk">Props:</strong> </div>'),ja=X('<div class="tech-details svelte-t9pjlk"><!> <!> <!> <!></div>'),za=X('<div class="list-item-details svelte-t9pjlk"><!> <!></div>'),La=X('<div role="listitem"><div class="list-item-header svelte-t9pjlk"><div class="list-item-main svelte-t9pjlk"><span class="position svelte-t9pjlk"> </span> <button class="title svelte-t9pjlk"> </button> <!> <span class="duration svelte-t9pjlk"> </span> <div class="list-item-actions svelte-t9pjlk"><button><!></button> <button class="action-button delete-button svelte-t9pjlk" aria-label="Delete sketch" title="Delete sketch"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div> <div class="list-item-performers svelte-t9pjlk"> <!></div></div> <!></div>'),qa=X('<div class="list-view svelte-t9pjlk"></div>');function Fa(o,r){Te(r,!1),he(r,"sketches",24,()=>[]);let s=he(r,"filteredSketches",24,()=>[]),l=he(r,"expandedSketchId",8,null),u=he(r,"draggedSketch",8,null),_=he(r,"draggedOverIndex",8,null),f=he(r,"flipDurationMs",8,300);he(r,"selectedSketch",8,null);const y=Ue();function A(x){y("select",{sketch:x})}function m(x,w){y("lock",{id:x,locked:w})}function T(x){y("delete",{id:x})}function k(x,w){y("dragstart",{event:x,sketch:w})}function p(x,w){y("dragover",{event:x,index:w})}function V(){y("dragleave")}function Q(x,w){y("drop",{event:x,index:w})}function K(){y("dragend")}function J(x){return(x.character_performers?.length||0)!==x.chars}function C(x){const w=Math.floor(x/60),H=x%60;return w>0?`${w}h ${H}m`:`${H}m`}Ne();var P=qa();Ge(P,15,s,x=>x.id,(x,w,H)=>{var L=La();let M;var t=n(L),a=n(t),d=n(a),D=n(d);i(d);var I=c(d,2),N=n(I,!0);i(I);var ie=c(I,2);{var fe=v=>{Tt(v,{class:"warning-icon",size:16})};le(ie,v=>{J(e(w))&&v(fe)})}var pe=c(ie,2),te=n(pe,!0);i(pe);var re=c(pe,2),z=n(re);let ve;var G=n(z);{var Y=v=>{var q=Ea();F(v,q)},E=v=>{var q=$a();F(v,q)};le(G,v=>{e(w).locked?v(Y):v(E,!1)})}i(z);var O=c(z,2);i(re),i(a);var Z=c(a,2),ne=n(Z),ue=c(ne);{var h=v=>{var q=Oa(),B=n(q);i(q),ce(()=>ae(B,`(${(e(w).character_performers?.length||0)??""}/${e(w).chars??""} characters)`)),F(v,q)};le(ue,v=>{J(e(w))&&v(h)})}i(Z),i(t);var g=c(t,2);{var $=v=>{var q=za(),B=n(q);{var U=ee=>{var b=Pa(),S=c(n(b));i(b),ce(()=>ae(S,` ${e(w).description??""}`)),F(ee,b)};le(B,ee=>{e(w).description&&ee(U)})}var W=c(B,2);{var R=ee=>{var b=ja(),S=n(b);{var ye=de=>{var ge=Ia(),se=c(n(ge));i(ge),ce(()=>ae(se,` ${e(w).techDetails.costume??""}`)),F(de,ge)};le(S,de=>{e(w).techDetails.costume&&de(ye)})}var me=c(S,2);{var _e=de=>{var ge=Ta(),se=c(n(ge));i(ge),ce(()=>ae(se,` ${e(w).techDetails.stage_dressing??""}`)),F(de,ge)};le(me,de=>{e(w).techDetails.stage_dressing&&de(_e)})}var Ee=c(me,2);{var be=de=>{var ge=Ra(),se=c(n(ge));i(ge),ce(()=>ae(se,` ${e(w).techDetails.cues??""}`)),F(de,ge)};le(Ee,de=>{e(w).techDetails.cues&&de(be)})}var Se=c(Ee,2);{var ke=de=>{var ge=Ma(),se=c(n(ge));i(ge),ce(()=>ae(se,` ${e(w).techDetails.props??""}`)),F(de,ge)};le(Se,de=>{e(w).techDetails.props&&de(ke)})}i(b),F(ee,b)};le(W,ee=>{e(w).techDetails&&ee(R)})}i(q),F(v,q)};le(g,v=>{l()===e(w).id&&v($)})}i(L),ce((v,q,B,U)=>{M=Ie(L,1,"list-item svelte-t9pjlk",null,M,v),qe(L,"draggable",!e(w).locked),ae(D,`${e(w).position+1}.`),qe(I,"aria-label",`View details for ${e(w).title}`),ae(N,e(w).title),ae(te,q),ve=Ie(z,1,"action-button lock-button svelte-t9pjlk",null,ve,B),qe(z,"aria-label",e(w).locked?"Unlock sketch":"Lock sketch"),qe(z,"title",e(w).locked?"Unlock sketch":"Lock sketch"),ae(ne,`${U??""} `)},[()=>({expanded:l()===e(w).id,locked:e(w).locked,dragging:u()?.id===e(w).id,"drag-over":_()===e(H)}),()=>C(e(w).duration),()=>({locked:e(w).locked}),()=>(e(w).character_performers||[]).map(v=>v.performer_name).join(", ")],ze),oe("click",I,()=>A(e(w))),oe("keydown",I,v=>v.key==="Enter"&&A(e(w))),oe("click",z,rt(()=>m(e(w).id,!e(w).locked))),oe("click",O,rt(()=>T(e(w).id))),$t(L,()=>Mt,()=>({duration:f()})),oe("dragstart",L,v=>k(v,e(w))),oe("dragover",L,v=>p(v,e(H))),oe("dragleave",L,V),oe("drop",L,v=>Q(v,e(H))),oe("dragend",L,K),F(x,L)}),i(P),F(o,P),Re()}var Aa=ct('<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z" clip-rule="evenodd"></path></svg>'),Va=ct('<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 11V7a4 4 0 118 0m-4 8v3m-6 2h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"></path></svg>'),Na=X('<span class="text-amber-500"> </span>'),Ua=X('<li class="flex justify-between"><span class="font-medium text-gray-700"> </span> <span class="text-gray-500"> </span></li>'),Ha=X('<div class="cast-list px-4 pb-3 pt-1 bg-gray-50"><ul class="text-xs space-y-1"></ul></div>'),Ba=X('<div class="border-t border-gray-200 px-4 py-2"><button class="cast-toggle text-sm text-blue-600 hover:text-blue-800 font-medium focus:outline-none w-full text-left flex justify-between items-center"><span> </span> <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div> <!>',1),Wa=X('<div tabindex="0" role="button" style="min-height: 150px;"><div class="p-4 flex-grow"><div class="flex justify-between items-center mb-2"><div class="flex items-center gap-2"><h3 class="text-lg font-semibold text-gray-800 truncate"> </h3> <!></div> <div class="flex items-center gap-0.5"><button><!></button> <button class="action-button delete-button svelte-1qd7kif" aria-label="Delete sketch" title="Delete sketch"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div> <p class="description text-sm text-gray-600 mb-3 line-clamp-1"> </p> <div class="stats text-xs text-gray-500 space-x-3 mb-3"><span> </span> <span> </span> <span> </span> <!></div></div> <!></div>');function Ka(o,r){Te(r,!1);let s=he(r,"sketch",8),l=he(r,"isSelected",8,!1),u=he(r,"showCharacterWarning",8,!1),_=we(!1);const f=Ue();function y(O){O.target instanceof HTMLElement&&O.target.closest("button, .cast-toggle")||O.target instanceof HTMLElement&&O.target.closest(".card")&&f("select",{sketch:s()})}function A(O){O.stopPropagation(),f("lock",{id:s().id,locked:!s().locked})}function m(O){O.stopPropagation(),f("delete",{id:s().id})}function T(O){O.stopPropagation(),j(_,!e(_))}function k(O){(O.key==="Enter"||O.key===" ")&&(O.preventDefault(),O.target instanceof HTMLElement&&O.target.closest("button, .cast-toggle")?O.target.closest(".cast-toggle")&&T(O):y(O))}Ne();var p=Wa(),V=n(p),Q=n(V),K=n(Q),J=n(K),C=n(J,!0);i(J);var P=c(J,2);{var x=O=>{Tt(O,{class:"warning-icon",size:16})};le(P,O=>{u()&&O(x)})}i(K);var w=c(K,2),H=n(w);let L;var M=n(H);{var t=O=>{var Z=Aa();F(O,Z)},a=O=>{var Z=Va();F(O,Z)};le(M,O=>{s().locked?O(t):O(a,!1)})}i(H);var d=c(H,2);i(w),i(Q);var D=c(Q,2),I=n(D,!0);i(D);var N=c(D,2),ie=n(N),fe=n(ie);i(ie);var pe=c(ie,2),te=n(pe);i(pe);var re=c(pe,2),z=n(re);i(re);var ve=c(re,2);{var G=O=>{var Z=Na(),ne=n(Z);i(Z),ce(()=>ae(ne,`(${(s().character_performers?.length||0)??""}/${s().chars??""} characters)`)),F(O,Z)};le(ve,O=>{u()&&O(G)})}i(N),i(V);var Y=c(V,2);{var E=O=>{var Z=Ba(),ne=We(Z),ue=n(ne),h=n(ue),g=n(h);i(h);var $=c(h,2);i(ue),i(ne);var v=c(ne,2);{var q=B=>{var U=Ha(),W=n(U);Ge(W,5,()=>s().character_performers,R=>R.id||R.character_name+R.performer_name,(R,ee)=>{var b=Ua(),S=n(b),ye=n(S,!0);i(S);var me=c(S,2),_e=n(me,!0);i(me),i(b),ce(()=>{ae(ye,e(ee).character_name),ae(_e,e(ee).performer_name)}),F(R,b)}),i(W),i(U),Ot(3,U,()=>ga,()=>({duration:200})),F(B,U)};le(v,B=>{e(_)&&B(q)})}ce(()=>{qe(ue,"aria-expanded",e(_)),ae(g,`Show Cast (${s().character_performers.length??""})`),Ie($,0,`w-4 h-4 transform transition-transform duration-200 ${e(_)?"rotate-180":""}`)}),oe("click",ue,T),F(O,Z)};le(Y,O=>{s().character_performers&&s().character_performers.length>0&&O(E)})}i(p),ce(O=>{Ie(p,1,`card ${l()?"selected border-blue-500":"border-gray-200"} ${s().locked?"locked":""} border bg-white rounded-lg shadow hover:shadow-md transition-all duration-200 flex flex-col`,"svelte-1qd7kif"),qe(p,"aria-label",`View sketch details for ${s().title??""}`),qe(J,"title",s().title),ae(C,s().title),L=Ie(H,1,"action-button lock-button svelte-1qd7kif",null,L,O),qe(H,"aria-label",s().locked?"Unlock sketch":"Lock sketch"),qe(H,"title",s().locked?"Unlock sketch":"Lock sketch"),qe(D,"title",s().description||"A sketch waiting for its story..."),ae(I,s().description||"A sketch waiting for its story..."),ae(fe,`Duration: ${s().duration??""} min`),ae(te,`Chars: ${s().chars??""}`),ae(z,`Casted: ${s().casted??""}`)},[()=>({locked:s().locked})],ze),oe("click",H,rt(A)),oe("click",d,rt(m)),oe("click",p,y),oe("keydown",p,k),F(o,p),Re()}var Ga=X('<div role="listitem"><!></div>'),Ja=X('<div class="grid-view svelte-1q07nmr"></div>');function Qa(o,r){Te(r,!1),he(r,"sketches",24,()=>[]);let s=he(r,"filteredSketches",24,()=>[]);he(r,"expandedSketchId",8,null);let l=he(r,"draggedSketch",8,null),u=he(r,"draggedOverIndex",8,null),_=he(r,"flipDurationMs",8,300);he(r,"selectedSketch",8,null);const f=Ue();function y(C){f("select",{sketch:C})}function A(C){f("lock",C.detail)}function m(C){f("delete",C.detail)}function T(C,P){f("dragstart",{event:C,sketch:P})}function k(C,P){f("dragover",{event:C,index:P})}function p(){f("dragleave")}function V(C,P){f("drop",{event:C,index:P})}function Q(){f("dragend")}function K(C){return(C.character_performers?.length||0)!==C.chars}Ne();var J=Ja();Ge(J,15,s,C=>C.id,(C,P,x)=>{var w=Ga();let H;var L=n(w);const M=ze(()=>K(e(P)));Ka(L,{get sketch(){return e(P)},get showCharacterWarning(){return e(M)},$$events:{update:()=>{},select:()=>y(e(P)),lock:A,delete:m}}),i(w),ce(t=>{H=Ie(w,1,"sketch-list-item svelte-1q07nmr",null,H,t),qe(w,"draggable",!e(P).locked)},[()=>({locked:e(P).locked,dragging:l()?.id===e(P).id,"drag-over":u()===e(x)})],ze),$t(w,()=>Mt,()=>({duration:_()})),oe("dragstart",w,t=>T(t,e(P))),oe("dragover",w,t=>k(t,e(x))),oe("dragleave",w,p),oe("drop",w,t=>V(t,e(x))),oe("dragend",w,Q),F(C,w)}),i(J),F(o,J),Re()}var Za=X('<div class="print-header svelte-vw1bf2"><div class="left svelte-vw1bf2"><button class="back-btn svelte-vw1bf2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><path d="m15 18-6-6 6-6"></path></svg> Back to Show</button> <h2 class="print-title svelte-vw1bf2"> </h2></div> <div class="right svelte-vw1bf2"><div class="performer-filter-wrapper svelte-vw1bf2"><!></div> <div class="print-version-btns svelte-vw1bf2"><button>Greenroom</button> <button>Hallway</button> <button>Tech Booth</button></div> <button class="print-btn svelte-vw1bf2" aria-label="Print set list"><!></button></div></div>');function Ya(o,r){Te(r,!1);let s=he(r,"printVersion",8,"greenroom"),l=he(r,"printViewPerformer",8,null),u=he(r,"performers",24,()=>[]);const _=Ue();function f(D){_("versionChange",{printVersion:D})}function y(D){_("performerSelect",{performer:D.detail.performer})}function A(){_("back")}function m(){_("print")}Ne();var T=Za(),k=n(T),p=n(k),V=c(p,2),Q=n(V);i(V),i(k);var K=c(k,2),J=n(K),C=n(J);Rt(C,{get performers(){return u()},get selectedPerformer(){return l()},$$events:{select:y}}),i(J);var P=c(J,2),x=n(P);let w;var H=c(x,2);let L;var M=c(H,2);let t;i(P);var a=c(P,2),d=n(a);It(d,{size:20}),i(a),i(K),i(T),ce((D,I,N)=>{ae(Q,`Print View - ${s()??""}`),w=Ie(x,1,"print-view-button svelte-vw1bf2",null,w,D),L=Ie(H,1,"print-view-button svelte-vw1bf2",null,L,I),t=Ie(M,1,"print-view-button svelte-vw1bf2",null,t,N)},[()=>({active:s()==="greenroom"}),()=>({active:s()==="hallway"}),()=>({active:s()==="techbooth"})],ze),oe("click",p,A),oe("click",x,()=>f("greenroom")),oe("click",H,()=>f("hallway")),oe("click",M,()=>f("techbooth")),oe("click",a,m),F(o,T),Re()}async function Xa(o,r){try{const s=await fetch("/api/optimize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sketches:o.map(u=>({id:u.id,title:u.title,cast:u.character_performers?.map(_=>_.performer_name)||[]})),constraints:r})});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return await s.json()}catch(s){return console.error("Failed to optimize running order:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error",order:[],metrics:{cast_overlaps:0}}}}var es=X('<div class="fixed inset-0 z-50 overflow-auto bg-white"><!> <div class="p-4"><!></div></div>'),ts=X('<div class="modal-backdrop svelte-pz2bd9" role="dialog" aria-modal="true" aria-label="Sketch details"><div class="modal-content svelte-pz2bd9" role="document"><!></div></div>'),rs=X('<div class="show-page svelte-pz2bd9"><!> <div class="content svelte-pz2bd9"><!> <!> <!></div></div>');function fs(o,r){Te(r,!1);const[s,l]=ar(),u=()=>rr(wr,"$page",s),_=we(),f=we(),y=we();let A=he(r,"data",8);Ue();const m=u().params.id;let T=A().show,k=we(A().sketches),p=we(null),V=we(null),Q=we("list");const K=300;let J=we(!1),C=we("greenroom"),P=we(null),x=we(null),w=we(null),H=we(null),L=we(!1),M=!1;yt(async()=>{await ve()});async function t(h){try{const{importType:g,data:$}=h.detail;if(g==="unknown"){console.error("Import type is unknown. Aborting."),alert("Could not determine CSV type. Please check file format.");return}let v;g==="sketches"?v={show_id:m,importType:g,data:$.map((U,W)=>({...U,position:e(k).length+W}))}:v={show_id:m,importType:g,data:$};const q=await fetch("/api/sketches/import",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)});if(!q.ok){const U=await q.json().catch(()=>({error:"Failed to import data. Unknown error."}));throw new Error(U.error||"Failed to import data")}const B=await q.json();if(g==="sketches"){const U=B.filter(W=>W.success&&W.sketch).map(W=>W.sketch);if(U.length>0)j(k,[...e(k),...U].sort((W,R)=>W.position-R.position)),alert(`${U.length} sketch(es) imported successfully.`);else{const W=B.filter(R=>!R.success);W.length>0?(alert(`Import partially failed. ${W.length} sketch(es) had issues. Check console for details.`),console.error("Sketch import errors:",W)):alert("No new sketches were imported. The file might have been empty or all rows failed.")}}else{const U=B.filter(R=>R.success).length,W=B.length-U;alert(`Tech details import complete. ${U} successful, ${W} failed. Check console for details.`),W>0&&console.error("Tech detail import issues:",B.filter(R=>!R.success)),await ve()}}catch(g){console.error("Error importing data:",g),alert(`Error during import: ${g instanceof Error?g.message:"Unknown error"}`)}}async function a(h){try{if(!(await fetch(`/api/sketches/${h.detail.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({locked:h.detail.locked})})).ok)throw new Error("Failed to update sketch");j(k,e(k).map($=>$.id===h.detail.id?{...$,locked:h.detail.locked}:$))}catch(g){console.error("Error updating sketch:",g)}}function d(h,g){a(new CustomEvent("lock",{detail:{id:h,locked:g}}))}async function D(h){const g=h.detail.id;if(g)try{if(!(await fetch(`/api/sketches/${g}`,{method:"DELETE"})).ok)throw new Error("Failed to delete sketch");const v=e(k).findIndex(q=>q.id===g);j(k,e(k).filter(q=>q.id!==g)),j(k,e(k).map((q,B)=>({...q,position:B}))),e(p)?.id===g&&j(p,null),await z(e(k))}catch($){console.error("Error deleting sketch:",$)}}function I(h){D(new CustomEvent("delete",{detail:{id:h}}))}async function N(h){try{if(!(await fetch(`/api/sketches/${h.detail.sketch.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(h.detail.sketch)})).ok)throw new Error("Failed to update sketch");j(k,e(k).map($=>$.id===h.detail.sketch.id?h.detail.sketch:$).sort(($,v)=>$.position-v.position)),e(p)?.id===h.detail.sketch.id&&j(p,h.detail.sketch)}catch(g){console.error("Error updating sketch:",g)}}function ie(h,g){if(g.locked){h.preventDefault();return}j(x,g),h.dataTransfer&&(h.dataTransfer.effectAllowed="move")}function fe(h,g){h.preventDefault(),!(!e(x)||e(x).locked||e(f)[g].locked)&&(j(w,g),h.dataTransfer&&(h.dataTransfer.dropEffect="move"))}function pe(){j(w,null)}async function te(h,g){if(h.preventDefault(),!e(x)||e(x).locked||e(f)[g].locked)return;const v=[...e(f)],q=v.findIndex(B=>B.id===e(x)?.id);if(q!==-1){v.splice(q,1),v.splice(g,0,e(x));const B=v,U=new Map(B.map((R,ee)=>[R.id,ee])),W=e(k).map(R=>{if(R.locked)return R;const ee=U.get(R.id);return{...R,position:ee!==void 0?ee:R.position}}).sort((R,ee)=>R.position-ee.position).map((R,ee)=>({...R,position:ee}));j(k,W),await z(W)}j(x,null),j(w,null)}function re(){j(x,null),j(w,null)}async function z(h){const g=h.map($=>({id:$.id,position:$.position}));try{if(!(await fetch("/api/sketches",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({updates:g})})).ok)throw console.error("Failed to reorder sketches API call failed"),await ve(),new Error("Failed to reorder sketches")}catch($){console.error("Error reordering sketches:",$),await ve()}}async function ve(){try{const h=await fetch(`/api/sketches?show_id=${m}`);if(!h.ok)throw new Error("Failed to load sketches");const g=await h.json();j(k,g.map($=>({...$,position:$.position??0,locked:!!$.locked})).sort(($,v)=>$.position-v.position))}catch(h){console.error("Error loading sketches:",h),j(k,[])}}function G(){j(J,!0),setTimeout(()=>{window.print(),j(J,!1)},100)}function Y(h){j(P,e(P)===h?null:h)}async function E(){if(!M){M=!0;try{const g={anchored:e(k).filter(v=>v.locked).map(v=>({sketch_id:v.id,position:v.position}))},$=await Xa(e(k),g);if($.success){const v=e(k).map(q=>{const B=$.order.find(U=>U.sketch_id===q.id);return{...q,position:B?.position??q.position}}).sort((q,B)=>q.position-B.position);await z(v),j(k,v),alert(`Optimization complete! Cast overlaps reduced to ${$.metrics.cast_overlaps}`)}else alert("Failed to optimize running order: "+($.error||"Unknown error"))}catch(h){console.error("Error optimizing running order:",h),alert("Failed to optimize running order. Please try again.")}finally{M=!1}}}it(()=>e(k),()=>{j(_,[...new Set(e(k).flatMap(h=>h.character_performers||[]).map(h=>h.performer_name))].sort())}),it(()=>(e(V),e(k)),()=>{j(f,e(V)?e(k).filter(h=>h.character_performers?.some(g=>g.performer_name===e(V))):e(k))}),it(()=>(e(H),e(k)),()=>{j(y,e(H)?e(k).filter(h=>h.character_performers?.some(g=>g.performer_name===e(H))):e(k))}),Ct(),Ne();var O=Je(),Z=We(O);{var ne=h=>{var g=es(),$=n(g);Ya($,{get printVersion(){return e(C)},get printViewPerformer(){return e(H)},get performers(){return e(_)},$$events:{back:()=>j(J,!1),versionChange:B=>j(C,B.detail.printVersion),performerSelect:B=>j(H,B.detail.performer),print:G}});var v=c($,2),q=n(v);ta(q,{get sketches(){return e(y)},get showTitle(){return T.title},get version(){return e(C)}}),i(v),i(g),F(h,g)},ue=h=>{var g=rs(),$=n(g);ya($,{show:T,get performers(){return e(_)},get selectedPerformer(){return e(V)},set selectedPerformer(b){j(V,b)},get printVersion(){return e(C)},set printVersion(b){j(C,b)},get isSidebarCollapsed(){return e(L)},set isSidebarCollapsed(b){j(L,b)},$$events:{collapse:({detail:b})=>j(L,b.collapsed),filter:({detail:b})=>j(V,b.performer),print:({detail:b})=>{j(C,b.printVersion),G()},importComplete:ve,csvImport:t},$$legacy:!0});var v=c($,2),q=n(v);Sa(q,{get viewMode(){return e(Q)},set viewMode(b){j(Q,b)},get printVersion(){return e(C)},set printVersion(b){j(C,b)},get showPrintView(){return e(J)},set showPrintView(b){j(J,b)},$$events:{viewModeChange:b=>j(Q,b.detail.viewMode),printVersionChange:b=>j(C,b.detail.printVersion),showPrintViewChange:b=>j(J,b.detail.showPrintView),optimize:E},$$legacy:!0});var B=c(q,2);{var U=b=>{Fa(b,{get sketches(){return e(k)},get filteredSketches(){return e(f)},get draggedSketch(){return e(x)},get draggedOverIndex(){return e(w)},flipDurationMs:K,get expandedSketchId(){return e(P)},set expandedSketchId(S){j(P,S)},get selectedSketch(){return e(p)},set selectedSketch(S){j(p,S)},$$events:{select:S=>j(p,S.detail.sketch),lock:S=>d(S.detail.id,S.detail.locked),delete:S=>I(S.detail.id),expand:S=>Y(S.detail.sketchId),dragstart:S=>ie(S.detail.event,S.detail.sketch),dragover:S=>fe(S.detail.event,S.detail.index),dragleave:pe,drop:S=>te(S.detail.event,S.detail.index),dragend:re},$$legacy:!0})},W=b=>{Qa(b,{get sketches(){return e(k)},get filteredSketches(){return e(f)},get draggedSketch(){return e(x)},get draggedOverIndex(){return e(w)},flipDurationMs:K,get expandedSketchId(){return e(P)},set expandedSketchId(S){j(P,S)},get selectedSketch(){return e(p)},set selectedSketch(S){j(p,S)},$$events:{select:S=>j(p,S.detail.sketch),lock:S=>d(S.detail.id,S.detail.locked),delete:S=>I(S.detail.id),expand:S=>Y(S.detail.sketchId),dragstart:S=>ie(S.detail.event,S.detail.sketch),dragover:S=>fe(S.detail.event,S.detail.index),dragleave:pe,drop:S=>te(S.detail.event,S.detail.index),dragend:re},$$legacy:!0})};le(B,b=>{e(Q)==="list"?b(U):b(W,!1)})}var R=c(B,2);{var ee=b=>{var S=ts(),ye=n(S),me=n(ye);Br(me,{get sketch(){return e(p)},$$events:{close:()=>j(p,null),update:N}}),i(ye),i(S),oe("click",ye,rt(function(_e){fr.call(this,r,_e)})),oe("click",S,()=>j(p,null)),oe("keydown",S,_e=>_e.key==="Escape"&&j(p,null)),F(b,S)};le(R,b=>{e(p)&&b(ee)})}i(v),i(g),F(h,g)};le(Z,h=>{e(J)?h(ne):h(ue,!1)})}F(o,O),Re(),l()}export{fs as component};
